<!--<div class="row">
    <div class="col-md-2">
        <div class="btn-group btn-group-vertical btn-group-lg" role="group">
            <button class="btn btn-light"  href="" type="button">
                任务看板
            </button>
            &lt;!&ndash;<button class="btn btn-light" th:href="@{task/queryArchive/{userId}(userId=${userId})}" type="button">
                归档任务
            </button>
            <button class="btn btn-light" type="button">
                回收站
            </button>&ndash;&gt;
            <button class="btn btn-light" type="button" href="task/url/report">
                数据报表
            </button>
        </div>
    </div>
    <div class="col-md-9" id="content"/>
    &lt;!&ndash;<div class="col-md-3">
        <br>
        <div class="carousel slide" id="carousel-614407">
            <ol class="carousel-indicators">
                <li data-slide-to="0" data-target="#carousel-614407">
                </li>
                <li data-slide-to="1" data-target="#carousel-614407">
                </li>
                <li data-slide-to="2" data-target="#carousel-614407" class="active">
                </li>
            </ol>
            <div class="carousel-inner">
                <div class="carousel-item">
                    <img class="d-block w-100" alt="Carousel Bootstrap First" src="https://www.layoutit.com/img/sports-q-c-1600-500-1.jpg" />
                    <div class="carousel-caption">
                        <h4>
                            First Thumbnail label
                        </h4>
                        <p>
                            话题一
                        </p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img class="d-block w-100" alt="Carousel Bootstrap Second" src="https://www.layoutit.com/img/sports-q-c-1600-500-2.jpg" />
                    <div class="carousel-caption">
                        <h4>
                            Second Thumbnail label
                        </h4>
                        <p>
                            话题二
                        </p>
                    </div>
                </div>
                <div class="carousel-item active">
                    <img class="d-block w-100" alt="Carousel Bootstrap Third" src="https://www.layoutit.com/img/sports-q-c-1600-500-3.jpg" />
                    <div class="carousel-caption">
                        <h4>
                            Third Thumbnail label
                        </h4>
                        <p>
                            话题三
                        </p>
                    </div>
                </div>
            </div> <a class="carousel-control-prev" href="#carousel-614407" data-slide="prev"><span class="carousel-control-prev-icon"></span> <span class="sr-only">Previous</span></a> <a class="carousel-control-next" href="#carousel-614407" data-slide="next"><span class="carousel-control-next-icon"></span> <span class="sr-only">Next</span></a>
        </div>
        <hr>
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <img class="card-img-top" alt="Bootstrap Thumbnail First" src="https://www.layoutit.com/img/people-q-c-600-200-1.jpg" />
                    <div class="card-block">
                        <h5 class="card-title">
                            Card title
                        </h5>
                        <p class="card-text">
                            C
                        </p>
                        <p>
                            <a class="btn btn-primary" href="#">Action</a> <a class="btn" href="#">Action</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <img class="card-img-top" alt="Bootstrap Thumbnail Second" src="https://www.layoutit.com/img/city-q-c-600-200-1.jpg" />
                    <div class="card-block">
                        <h5 class="card-title">
                            Card title
                        </h5>
                        <p class="card-text">
                            PHP
                        </p>
                        <p>
                            <a class="btn btn-primary" href="#">Action</a> <a class="btn" href="#">Action</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <img class="card-img-top" alt="Bootstrap Thumbnail Third" src="https://www.layoutit.com/img/sports-q-c-600-200-1.jpg" />
                    <div class="card-block">
                        <h5 class="card-title">
                            Card title
                        </h5>
                        <p class="card-text">
                            Java
                        </p>
                        <p>
                            <a class="btn btn-primary" href="#">Action</a> <a class="btn" href="#">Action</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>&ndash;&gt;
</div>-->
<div class="row">
    <div class="col-2">
        <div class="nav nav-pills flex-column text-center">
            <a href="#tab1" id="taskBoard" class="nav-link active" data-toggle="tab">任务跟踪</a>
            <a href="#tab2" class="nav-link" data-toggle="tab">个人任务</a>
            <a href="#tab3" class="nav-link" data-toggle="tab">发布任务</a>
            <a href="#tab4" class="nav-link" data-toggle="tab">任务统计</a>
        </div>
    </div>
    <div class="col-10 tab-content w-75 mt-3 mb-5">
        <div class="tab-pane fade show active" id="tab1">
            <nav class="nav nav-tabs">
                <a href="#ingDiv" class="nav-link active" data-toggle="tab">进行中</a>
                <!--<a href="#todo" class="nav-link teacherChoice" data-toggle="tab">待批阅</a>-->
                <a href="#end" class="nav-link" data-toggle="tab">已结束</a>
            </nav>
            <div class="tab-content mt-3">
                <div class="tab-pane fade show active" id="ingDiv">
                    <div id="ing" class="row">
                        <span class="badge-light">还没有任务哦！快去创建吧！</span>
                    </div>
                </div>
                <div class="tab-pane fade show" id="end">
                    <h3>待批阅</h3>
                    <div id="todo" class="row mb-3">
                        <span class="badge-light">还没有待批阅任务哦！快去创建吧！</span>
                    </div>
                    <hr>
                    <h3>已完成</h3>
                    <div id="done" class="row">
                        <span class="badge-light">还没有已完成的任务哦</span>
                    </div>
                </div>
                <!--<div class="tab-pane fade show" id="todo">
                    带批阅 直接展示所有待批阅的user_task
                </div>-->
            </div>
        </div>
        <div class="tab-pane fade" id="tab2">
            <div class="card text-black-50 mb-3" style="width: 18rem;">
                <div class="card-header">
                    <h4 class="card-title text-truncate">个人任务</h4>
                </div>
                <div class="card-body">
                    <span class="badge-light">开始时间：2020-04-20 9:00</span>
                    <div class="w-100"></div>
                    <span class="badge-light">截止时间：2020-04-20 9:00</span>
                    <div class="w-100"></div>
                    <span class="badge-light">任务状态：已批阅</span>
                </div>
                <div class="card-footer">
                    <span class="badge-success float-left">85分</span>
                    <a class="btn btn-primary float-right" data-toggle="tab" href="#tab5">查看</a>
                </div>
            </div>
        </div>
        <div class="tab-pane fade" id="tab3">
            <form role="form" id="addTaskForm" action="task/insertTask" method="post" enctype="multipart/form-data">
                <div class="form-group">
                    <label>
                        任务名
                    </label>
                    <input type="text" class="form-control" name="taskName" required/>
                </div>
                <div class="form-group">
                    <label>
                        任务描述
                    </label>
                    <textarea rows="10" type="text" class="form-control" id="taskDesc" name="taskDesc" required></textarea>
                </div>
                <div class="form-group">
                    <label for="taskChoice">任务模式</label>
                    <select class="form-control" id="taskChoice" name="taskType">
                        <option value="0">团队任务</option>
                        <option value="1">个人任务</option>
                    </select>
                </div>

                <div id="groupTask" class="teacherChoice">
                    <div class="form-group">
                        <label for="choiceMode">指派方式</label>
                        <select class="form-control" id="choiceMode" name="choiceMode">
                            <option value="0">指派班级</option>
                            <option value="1">指派人员</option>
                        </select>
                    </div>
                    <div class="form-group" id="classMode">
                        <label>班级</label>
                        <select class="form-control" id="classControl" name="classId[]" multiple>

                        </select>
                    </div>
                    <div id="userMode" hidden="true">
                        <div class="form-group form-inline" id="userSpan">
                            <span class="badge badge-primary mr-3">成员</span>
                        </div>
                        <div class="form-group dropdown" id="addUserDropdown">
                            <label for="addUser">
                                添加成员
                            </label>
                            <input type="text" class="form-control" id="addUser" data-toggle="dropdown"/>
                            <div class="dropdown-menu w-100" id="userDropdownInfo">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="datetimepicker1">到期时间</label>
                    <div class="input-group date" id="datetimepicker1" data-target-input="nearest"
                         data-target="#datetimepicker1" data-toggle="datetimepicker">
                        <input type="text" name="deadTime" class="form-control datetimepicker-input w-25" data-target="#datetimepicker1" required/>
                        <div class="input-group-append">
                            <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        上传附件
                    </label>
                    <input type="file" class="form-control-file" name="file"/>
                    <!--<p class="help-block">
                        请上传任务相关教学文件
                    </p>-->
                </div>
                <div class="checkbox">
                    <label>
                        <input type="checkbox" checked/> 跟踪任务
                    </label>
                </div>
                <input name="updateUser" class="updateUser" hidden/>
                <button type="submit" class="btn btn-primary" id="addTaskBtn">
                    提交
                </button>
            </form>
        </div>
        <div class="tab-pane fade" id="tab4">
            做展示页面
        </div>
        <div class="tab-pane fade" id="tab5">
            查看任务详情
            <button type="button" class="btn btn-primary" data-toggle="tab" href="#tab6">修改</button>
        </div>
        <div class="tab-pane fade" id="tab6">修改任务</div>
    </div>

    <div class="modal" id="modal-container" aria-hidden="true" role="dialog">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        8000116377 张迁
                    </h5>
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group mb-3">
                        <h5 >
                            任务完成内容
                        </h5>
                        <span class="badge-pill d-block">任务完成内容</span>
                        <a href="${item.filepath}" download="${item.filename}" class="${item.filename==null?'hide':''}">${item.filename}</a>
                    </div>
                </div>
                <div class="modal-footer">
                    <input type="text" class="input-mini form-control-plaintext" value="99分" readonly/>
                    <button class="button btn-primary">修改</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(function(){
        //初始化任务追踪的ing
        $.ajax({
            url: "task/getTaskByUserId/"+userId,
            method: "GET",
            success: function (data) {
                console.log(data)
                if (data!=null){
                    if (data.doingList!=null&&data.doingList.length>0){
                        initIng(data.doingList);
                    }
                    if (data.waitList!=null&&data.waitList.length>0){
                        initTodo(data.waitList);
                    }
                    if (data.doneList!=null&&data.doneList.length>0){
                        initDone(data.doneList);
                    }
                }
            }
        })

        let task;
        let submitted = 0;
        /*点击任务看板的查看按钮*/
        $('body').on('click', '.showTaskInfo', function () {
            let taskId = $(this).attr('name');
            $.ajax({
                url: 'task/getTaskById/' + taskId+ "/" + userId,
                method: 'GET',
                success: function (data) {
                    console.log(data)
                    task = data;
                    let total = 0;
                    if (data!=null){
                        document.getElementById('tab5').innerHTML = initTab5(data);
                        /*隐藏控件*/
                        $('.hide').attr("hidden",true);
                        /*初始化班级或用户*/
                        if (data.choiceMode=='0'){
                            initClassReadOnly(data.classList);
                        }else {
                            initUserReadOnly(data.memberArr);
                        }
                        /*初始化content*/
                        if (data.unReviewedTaskContentList!=null){
                            initTaskContent(data.unReviewedTaskContentList, document.getElementById('review'));
                        }
                        if (data.reviewedTaskContentList!=null){
                            initTaskContent(data.reviewedTaskContentList, document.getElementById('reviewed'));
                        }
                        total = data.unReviewedTaskContentList.length + data.reviewedTaskContentList.length;
                    }
                    $('#unSubmit').text('未提交：'+ (total-submitted) +'人');
                    $('#submitted').text('已提交：'+submitted+'人');
                }
            })
        })

        /*对学生仅开放个人任务*/
        if (role == 2){
            $('#taskChoice').html('<option value="1">个人任务</option>');
            $('.teacherChoice').prop('hidden',true);
        }

        /*初始化班级下拉菜单*/
        if (role == 1){
            $.ajax({
                method: 'GET',
                url: "task/getClassList/"+userId,
                success: function (data) {
                    initClass(data);
                }
            })
        }

        /*初始化日期控件*/
        let timestamp=new Date().getTime();
        $('#datetimepicker1').datetimepicker({
            format: 'L',//显示日期格式为月日年

            minDate: new Date(timestamp+1*60*60*1000),//过期时间不可选择

            format: 'YYYY-MM-DD HH:00'   //日期格式

            //allowMultidate: true,//允许日期多选

            //multidateSeparator: ','//多个时间以逗号隔开
        });

        /*点击个人任务，隐藏团队输入框*/
        $('#choiceMode').change(function () {
            let choice = $(this).val();
            if (choice == '0'){
                $('#classMode').prop('hidden',false);
                $('#userMode').prop('hidden',true);
            }else {
                $('#classMode').prop('hidden',true);
                $('#userMode').prop('hidden',false);
            }
        })

        /*选择指派任务模式*/
        $('#taskChoice').change(function () {
            let choice = $(this).val();
            if (choice == '1'){
                $('#groupTask').prop('hidden',true);
            }else {
                $('#groupTask').attr('hidden',false);
            }
        })

        /*点击下拉框中的用户，添加用户*/
        $('#addUser').on('input propertychange', function() {
            //监听文本框
            //清除
            $('#userDropdownInfo').empty();
            /*展示下拉框之前，使用动态渲染，实现对下拉框的渲染*/
            let value = $(this).val();
            if (value!=null && value.trim()!=''){
                $.ajax({
                    url: "task/queryUserId/"+userId+"/"+value,
                    method: "GET",
                    success: function (data) {
                        if (data!=null && data!=''){
                            let html = data.map(item=>{
                                return `
                                 <a href="#" class="dropdown-item userSearch">${item}</a>
                            `
                            }).join('');
                            $('#userDropdownInfo').append(html);
                        }
                    }
                })
            }
            $('.dropdown-toggle').dropdown();
        });

        let usernameArr = [];
        /*点击下拉菜单中的数据，将用户添加到上方成员中*/
        $("body").on('click','.userSearch',function(){
            let username = $(this).text();
            $(this).attr("hidden",true);
            usernameArr.push(username);
            addUserToSpan(usernameArr);
            return false;
        });

        /*点击userSpan中的复选框，将用户删除*/
        $("body").on('click','.usernameSpanCheckbox',function(){
            let username = $(this).attr('name');
            let index = usernameArr.indexOf(username);
            if (index > -1) {
                usernameArr.splice(index, 1);
            }
            addUserToSpan(usernameArr);
            return false;
        });

        //点击添加
        $('#addTaskBtn').click(function () {
            $('.updateUser').val(userId)
            let content=$('#taskDesc').val();
            $('#taskDesc').val(content.replace(/\n/g, '<br/>').replace(/\s/g, ' '));
            $("#addTaskForm").submit();
        })

        //点击修改按钮
        $("body").on('click','#modifyTaskBtn',function(){
            //展示选项

            //隐藏content

            //隐藏修改按钮，显示提交按钮
            $('#modifyTaskBtn').attr("hidden",true);
            $('#delTaskBtn').attr("hidden",true);
            $('#submitModifyTaskBtn').attr("hidden",false);
            return false;
        });

        //修改后点击提交
        $("body").on('click','#delTaskBtn',function(){
            let taskId = $(this).attr('name');
            $.ajax({
                url: 'task/delTaskById/'+ taskId + "/" + userId,
                method: 'DELETE',
                success: function () {
                    location.reload();
                }
            })
        });

        //修改后点击提交
        $("body").on('click','#submitModifyTaskBtn',function(){
            $('.updateUser').val(userId);
            let content=$('#taskDesc').val();
            msg = content.replace(/\n/g, '<br/>').replace(/\s/g, ' ');
            $("#modifyTaskForm").submit();
        });

        //点击任务，弹出模态框
        $("body").on('show.bs.modal', '#modal-container', function (event) {
            let button = $(event.relatedTarget);
            //设置title
            let title = button.data('title');
            let modal = $(this);
            modal.find('.modal-title').text(title);
            //初始化body
            let taskInfoId = button.data('id');

        });
        //关闭模态框，对分数做修改，并修改任务状态为reviewed
        $("body").on('hide.bs.modal', '#modal-container', function (event) {
            //清除缓存，避免出现重复事件
            $.ajax({cache: false})
            //判断分数是否为空，或是否与原分数相同，然后对分数做修改，并修改任务状态为reviewed
            $('#taskSystem').load('task/queryTaskInfoById/'+taskId+'/'+isAdmin+'/'+userId);

            //最后刷新页面，重新触发点击事件或reload
        })


        /*使用动态渲染，实现对用户的添加*/
        function addUserToSpan(arr){
            let html = arr.map(item=>{
                return `<div class="form-check">
                                    <input type="checkbox" class="form-check-input usernameSpanCheckbox" name="${item}" checked>
                                    <input class="form-control-plaintext form-check-label w-auto" name="members" value="${item}" readonly/>
                                </div>`
            }).join('');
            document.getElementById('userSpan').innerHTML = '<span class="badge badge-primary mr-3">成员</span>' + html;
        }

        function initUserReadOnly(arr){
            let html = arr.map(item=>{
                return `<div class="form-check">
                                    <input type="checkbox" class="form-check-input usernameSpanCheckbox" name="${item}" checked readonly>
                                    <input class="form-control-plaintext form-check-label w-auto" name="members" value="${item}" readonly/>
                                </div>`
            }).join('');
            document.getElementById('userSpanReadOnly').innerHTML = '<h5 class="mr-3">成员</h5>' + html;
        }

        function initClass(arr) {
            //let classArr = classList.split(",");
            //alert('classArr:'+ typeof classArr[0])

            let html = arr.map(item=>{
                return `
                     <option value="${item.id}">${item.classname}</option>
                `
            }).join('');
            $('#classControl').append(html);
        }

        function initClassReadOnly(arr) {
            let html = arr.map(item=>{
                return `
                     <div class="form-check">
                        <input type="checkbox" class="form-check-input classnameSpanCheckbox" name="${item.id}" checked readonly>
                        <input class="form-control-plaintext form-check-label w-auto" name="classIds" value="${item.classname}" readonly/>
                     </div>`
            }).join('');
            document.getElementById('classSpanReadOnly').innerHTML = '<h5 class="mr-3">班级</h5>' + html;
        }

        /*<input name="id" value="${item.id}" hidden>*/
        function initTab5(item) {
            return `<form role="form" id="modifyTaskForm" action="task/modifyTask" method="post" enctype="multipart/form-data">
                <div class="form-group">
                    <input type="text" class="form-control-plaintext badge-pill" name="taskName" value="${item.taskName}" readonly required/>
                    <hr>
                </div>
                <div class="form-group ${item.isAdmin == 1? 'hide' : ''}"  >
                    <span class="badge-light"> 学号：${item.content.updateUser} </span>
                </div>
                <div class="form-group mb-3">
                    <h5 >
                        任务描述
                    </h5>
                    <span class="badge-pill d-block">${item.taskDesc}</span>
                    <textarea rows="20" cols="20" type="text" class="text-area" name="taskDesc" hidden required></textarea>
                    <hr>
                </div>

                <div class="form-group" hidden>
                    <label>任务模式</label>
                    <span class="badge-light d-block">团队任务</span>
                    <input class="form-control-plaintext badge-light" name="taskType" value="0" hidden readonly/>
                </div>

                <div id="groupTask">
                    <div class="form-group" hidden>
                        <label for="choiceMode">指派方式</label>
                        <span class="badge-pill d-block">${item.classList == null? '指派成员' : '指派班级'}</span>
                        <input class="form-control-plaintext badge-light" name="choiceMode" value="${item.choiceMode}" readonly/>
                    </div>
                    <div class="form-group form-inline ${item.choiceMode=='0'?'':'hide'}" id="classSpanReadOnly" >
                    </div>
                    <div id="userMode" class="${item.choiceMode==1?'':'hide'}">
                        <div class="form-group form-inline" id="userSpanReadOnly">
                            <span class="badge badge-primary mr-3">成员</span>
                        </div>
                        <div class="form-group dropdown" id="addUserDropdown" hidden>
                            <label for="addUser">
                                添加成员
                            </label>
                            <input type="text" class="form-control" id="addUser" data-toggle="dropdown"/>
                            <div class="dropdown-menu w-100" id="userDropdownInfo">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="datetimepicker1">到期时间</label>
                    <div class="input-group date" id="datetimepicker1" data-target-input="nearest"
                         data-target="#datetimepicker1" data-toggle="datetimepicker">
                        <input type="text" name="deadTime" class="form-control datetimepicker-input w-25 form-control-plaintext badge-pill" value="${item.deadTime}" data-target="#datetimepicker1" readonly required/>
                        <div class="input-group-append" hidden>
                            <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        附件
                    </label>
                    <a href="${item.filepath}" download="${item.filename}" class="${item.filename==null?'hide':''}">${item.filename}</a>
                    <input type="file" class="form-control-file" name="file" hidden/>
                </div>
                <input name="updateUser" class="updateUser" hidden/>
                <div class="form-group">
                    <button class="btn btn-primary ${(item.isAdmin == 0||item.statusShow==1) ? 'hide' : ''}" id="modifyTaskBtn">
                        修改
                    </button>
                    <button class="btn btn-danger ${(item.isAdmin == 0||item.statusShow==1) ? 'hide' : ''}" id="delTaskBtn" name="${item.id}">
                        删除
                    </button>
                </div>
                <button class="btn btn-primary" id="submitModifyTaskBtn" hidden>
                    提交
                </button>
            </form>

            <h5 class="badge badge-danger" id="unSubmit">未提交：0人</h5>
            <h5 class="badge badge-success" id="submitted">已提交：0人</h5>

            <div class="${item.isAdmin == 0? 'hide' : ''}">
            <h4 class="mt-5">待批阅</h4>
            <div id="review" class="row mb-3">
                <span class="badge-light">还没有待批阅任务！</span>
            </div>
            <hr>
            <h4>已批阅</h4>
            <div id="reviewed" class="row mb-3">
                <span class="badge-light">还没有待批阅任务！</span>
            </div>
          </div>`;
        }

        function initIng(arr) {
            let html = arr.map(item=>{
                return `<div class="card text-black-50 mb-3 mr-3" style="width: 18rem;">
                        <div class="card-header">
                            <h4 class="card-title text-truncate">${item.taskName}</h4>
                        </div>
                        <div class="card-body">
                            <span class="badge-light">开始时间：${item.startTime}</span>
                            <div class="w-100"></div>
                            <span class="badge-light">截止时间：${item.deadTime}</span>
                            <div class="w-100"></div>
                            <span class="badge-light">任务状态：进行中</span>
                        </div>
                        <div class="card-footer">
                            <a class="btn btn-primary float-right showTaskInfo" data-toggle="tab" href="#tab5" name="${item.id}">查看</a>
                        </div>
                    </div>`
            }).join('');
            document.getElementById('ing').innerHTML = html;
        }
        /*<span class="badge-success float-left">${item.grade}分</span>*/
        function initTodo(arr) {
            let html = arr.map(item=>{
                return `<div class="card text-black-50 mb-3 mr-3" style="width: 18rem;">
                        <div class="card-header">
                            <h4 class="card-title text-truncate">${item.taskName}</h4>
                        </div>
                        <div class="card-body">
                            <span class="badge-light">开始时间：${item.startTime}</span>
                            <div class="w-100"></div>
                            <span class="badge-light">截止时间：${item.deadTime}</span>
                            <div class="w-100"></div>
                            <span class="badge-light">任务状态：待批阅</span>
                        </div>
                        <div class="card-footer">
                            <a class="btn btn-primary float-right showTaskInfo" data-toggle="tab" href="#tab5" name="${item.id}">批阅</a>
                        </div>
                    </div>`
            }).join('');
            document.getElementById('todo').innerHTML = html;
        }

        function initDone(arr) {
            let html = arr.map(item=>{
                return `<div class="card text-black-50 mb-3 mr-3" style="width: 18rem;">
                        <div class="card-header">
                            <h4 class="card-title text-truncate">${item.taskName}</h4>
                        </div>
                        <div class="card-body">
                            <span class="badge-light">开始时间：${item.startTime}</span>
                            <div class="w-100"></div>
                            <span class="badge-light">截止时间：${item.deadTime}</span>
                            <div class="w-100"></div>
                            <span class="badge-light">任务状态：已结束</span>
                        </div>
                        <div class="card-footer">
                            <a class="btn btn-primary float-right showTaskInfo" data-toggle="tab" href="#tab5" name="${item.id}">查看</a>
                        </div>
                    </div>`
            }).join('');
            document.getElementById('done').innerHTML = html;
        }

        function initTaskContent(arr, dom) {
            let html = arr.map(item=>{
                if (item!=null && item.content!=null){
                    submitted++;
                    return `<a data-toggle="modal" href="#modal-container" class="w-100 ml-3">${item.updateUser} ${item.username} ${item.grade==undefined?'':(item.grade+'分')}</a>`
                }
            }).join('');
            dom.innerHTML = html;
        }
    })
</script>